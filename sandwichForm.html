<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>ClassWork #6</title>
    <!-- Bootstrap CSS -->
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
    <!-- <link rel="stylesheet" href="sandwich.css" type="text/css"> -->

</head>

<body>
    <div class="container">
        <div class="row">
            <h1>Sandwich Order Form</h1>
            <div class="col-md-6">
                <form id="sandwich">
                    <div class="form-group">
                        <h3>Your Name</h3>
                        <input type="text" id="name" class="form-control" placeholder="Name">
                    </div>
                    <div class="form-group type">
                        <h3>Sandwich Type</h3>
                        <input type="radio" id="gyro" value="gyro" name="type">
                        <label for="gyro">Gyros</label>

                        <input type="radio" id="chicken" value="chicken" name="type">
                        <label for="chicken">Chicken Schwarma</label>

                        <input type="radio" id="falafel" value="falafel" name="type">
                        <label for="falafel">Falafel</label>
                    </div>
                    <div class="form-group" id="fillings">
                        <h3>Fillings</h3>
                        <input type="checkbox" id="lettuce" name="lettuce">
                        <label for="lettuce">Lettuce</label>

                        <input type="checkbox" id="salad" name="salad">
                        <label for="salad">Gyro Salad</label>

                        <input type="checkbox" id="tahini" name="tahini">
                        <label for="tahini">Tahini</label>

                        <input type="checkbox" id="spicy" name="spicy">
                        <label for="spicy">Hot Sauce</label>

                        <div id="extras">
                            <input type="checkbox" id="hummus" value="hummus" name="hummus">
                            <label for="hummus">Hummus (+ $1.00)</label>

                            <input type="checkbox" id="baba" value="baba" name="baba">
                            <label for="baba">Babaganouj (+ $1.00)</label>
                        </div>
                    </div>
                    <div class="form-group">
                        <h3>Make it a Meal</h3>
                        <input type="checkbox" id="meal" name="meal">
                        <label for="meal">Add fries and a drink (+ $ 2.00)</label>
                    </div>
                    <div>
                        <h2>Total Price:
                            <span class="price">$0.00</span>
                        </h2>
                    </div>
                    <button type="button" id="submit" class="btn btn-success">Submit Order</button>
                </form>
            </div>
            <div class="col-md-6" id="sandwichOrder">
                <h3>Current Sandwich Order</h3>
                <div>
                    <label>Customer Name:</label>
                    <span class="customer">#</span>
                </div>
                <div>
                    <label>Sandwich Type:</label>
                    <span class="sandwich-type">#</span>
                </div>
                <div>
                    <label>Fillings:</label>
                    <span class="sandwich-fillings">#</span>
                </div>
                <div>
                    <label>Meal:</label>
                    <span class="sandwich-meal">#</span>
                </div>
                <div>
                    <label>Total Price:</label>
                    <span class="sandwich-price">#</span>
                </div>


            </div>
        </div>
    </div>




    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js "></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js "></script>

    <script src="http://sabioapi2.azurewebsites.net/scripts/sabio.js "></script>

    <script type="text/javascript ">
        sabio.page.startUp = function () {
            $(".type").on("click", sabio.page.handlers.setPrice);
            $("#extras").on("click", sabio.page.handlers.addExtraToppings);
            $("#meal").on("click", sabio.page.handlers.addMealToPrice);
            $("#submit").on("click", sabio.page.handlers.submitOrder);

        };

        sabio.page.handlers.setPrice = function (event) {
            //check if price already set
            if (sabio.page.price == undefined) {
                //set price of sandwich
                sabio.page.price = 8.49;
            }
            //display price of sandwich
            $(".price").text("$" + sabio.page.price);
        }


        sabio.page.handlers.addExtraToppings = function (event) {
            if (sabio.page.price != undefined) {
                if ($(event.target).prop("checked")) {
                    //add $1.00
                    sabio.page.price += 1;
                } else {
                    sabio.page.price -= 1;
                }
                //display new price
                $(".price").text("$" + sabio.page.price);

            } else {
                alert("Please pick a sandwich type!");
                $(event.target).attr("checked", false);
            }
        }

        sabio.page.handlers.addMealToPrice = function (event) {
            if (sabio.page.price != undefined) {
                //if meal is checked, add to price
                if ($("#meal").prop("checked")) {
                    sabio.page.price += 2;
                    //if meal is deselected, subtract from price
                } else {
                    sabio.page.price -= 2;
                }
                //display new price
                $(".price").text("$" + sabio.page.price);

            } else {
                alert("Please pick a sandwich type!");
                $("#meal").attr("checked", false);
            }
        }

        sabio.page.handlers.submitOrder = function (event) {
            var nameCheck = $("#name").val();
            if (nameCheck != "" && sabio.page.price != undefined) {
                //get data from Form
                var data = sabio.page.grabData();
                //display data
                $(".customer").text(data.customerName);
                $(".sandwich-type").text(data.sandwichType);
                $(".sandwich-fillings").text(data.toppings);
                $(".sandwich-meal").text(data.meal);
                $(".sandwich-price").text(data.price);

                //reset price
                sabio.page.price = undefined;
                $(".price").text("$0.00");
                var reset = $("#sandwich");
                reset[0].reset();
            } else {
                alert("Please include your name and pick a sandwich type")

            }
        }



        sabio.page.grabData = function () {
            var sandwich = {};
            var toppings = [];

            //add fillings data into array
            $('#fillings input:checked').each(function () {
                toppings.push($(this).attr('name'));
            });

            //turn true/false into "yes" or "no" for meal option
            if ($("#meal").prop("checked")) {
                sandwich.meal = "yes";
            } else {
                sandwich.meal = "no";
            }

            //data from form 
            sandwich.customerName = $("#name").val();
            sandwich.sandwichType = $("input[name=type]:checked ").val();
            sandwich.price = sabio.page.price;
            sandwich.toppings = toppings;
            console.log(sandwich);
            return sandwich;
        }
    </script>

</body>

</html>